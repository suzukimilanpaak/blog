---
layout: post
title: "ひさびさにRedmineセットアップしたらエラーに遭遇"
date: '2010-06-10T21:23:00.003+01:00'
author: Suzuki MilanPaak
tags: 
modified_time: '2010-06-10T21:56:07.991+01:00'
blogger_id: tag:blogger.com,1999:blog-6758697817819098194.post-4715351983393866789
blogger_orig_url: http://engineerflies.blogspot.com/2010/06/redmine.html
---

久々にRedmineセットアップしたらちょこちょこ変更があったみたいでエラーに遭遇。メモしておきます。<br /><br /><h2>conf/environment.rbにsession keyの設定をしてない</h2><br />現在の安定版最新ver0.9.4のenvironment.rbに、Rails2.xのrails自動生成されるonfig.action_controller.session={}が記述されてないみたい。以下のエラーが出ていた。tailしてたら長い長いエラーメッセージに埋もれてしばらく気づかなかった。<br /><br /><pre class=ruby name=code><br />  The backend application (process 13999) did not send a valid HTTP response; instead, it sent nothing at all. It is possible that it has crashed; please check whether there are crashing bugs in this application.<br />*** Exception ArgumentError in application (A key is required to write a cookie containing the session data. Use config.action_controller.session = { :key => "_myapp_session", :secret => "some secret phrase" } in config/environment.rb) (process 13999):<br /></pre><br /><br /><a href=http://d.hatena.ne.jp/yssk22/20080101>Web屋の人の日記 || WebJourney 開発ログ</a>さんの記事を参考に解決。<br /><br />config/environment.rb<br /><pre class=ruby name=code><br />Rails::Initializer.run do |config|<br />:<br />  characters = ('a'..'z').to_a + ('A'..'Z').to_a + ('0'..'9').to_a<br />  secret = Array.new(48){characters[rand(characters.size)]}.join<br /><br />  config.action_controller.session = {<br />    :session_key => "_webjourney_session",<br />    :secret => secret<br />  }<br />:<br />end<br /></pre><br /><br />Phusion Passengerを使ってる場合Apacheをreloadしてspown serverに構成を再読み込みさせる必要があります。<br /><br /><br /><h2>No route matches "/index.html"</h2><br />Phusion Passenger を使ってるため以下のエラーに遭遇した。<a href=http://d.hatena.ne.jp/devillikeaangel/20090519/1242695462>devillikeaangelの日記</a>さんの記事を参考に修正。（まんまコピーですいません）<br /><br /><pre class=ruby name=code><br />ActionController::RoutingError (No route matches "/index.html" with {:method=>:get}):<br />Rendering /var/rails/redmine/public/404.html (404 Not Found)<br /></pre><br /><br />どうもmod_rewriteを有効にしてると、index.htmlを探しに行ってしまうみたい。<br /><br />以下、対処法の抜粋。<br /><br />passengerで動かすので、Rewriteはいらない。redmine/public/.htaccessにある以下の3行をコメントアウトする<br /><br /><pre class=ruby name=code><br />#RewriteRule ^$ index.html [QSA]<br />#RewriteRule ^([^.]+)$ $1.html [QSA]<br />#RewriteCond %{REQUEST_FILENAME} !-f<br /></pre><br /><br />.